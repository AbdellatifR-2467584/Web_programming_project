<!DOCTYPE html>
<html lang="nl">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ReciPin</title>
    <link rel="icon" type="image/png" href="/resources/logo/Logo_cirkel.png">
    <link rel="stylesheet" href="/css/post.css">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.1/font/bootstrap-icons.css">
    <script src="/js/post.js" defer></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2pdf.js/0.10.1/html2pdf.bundle.min.js"
        integrity="sha512-GsLlZN/3F2ErC5ifS5QtgpiJtWd43JWSuIgh7mbzZ8zBps+dvLusV+eNQATqgA/HdeKFVgA5v3S/cIrLF7QnIg=="
        crossorigin="anonymous" referrerpolicy="no-referrer"></script>
</head>

<body>
    <div class="layout">
        <%- include('partials/sidebar') %>

            <main class="mainarea">
                <%- include('partials/searchbar') %>

                    <section class="page">
                        <article class="post" id="post" data-title="<%= post.title %>"
                            data-current-user='<%= currentUser ? JSON.stringify(currentUser) : "" %>'>

                            <header class="post-header">
                                <h2 id="postTitel">
                                    <%= post.title %>
                                </h2>
                                <div class="post-header-buttons">
                                    <button id="clipboard" onclick="clipboard_copy()">
                                        <i class="bi bi-clipboard"></i>
                                    </button>
                                    <button id="pdf" onclick="download_pdf()">
                                        <i class="bi bi-file-earmark-pdf"></i>
                                    </button>
                                    <a href="/post/<%= post.id %>/volgmee" class="follow-along-icon" title="Volg Mee">
                                        <i class="bi bi-play-circle-fill"></i>
                                    </a>
                                </div>
                            </header>

                            <div class="container">
                                <figure class="picture">
                                    <img src="/<%= post.image_path %>" alt="Recipe">
                                    <figcaption id="poster">Gepost door: <%= post.username %>
                                    </figcaption>
                                </figure>

                                <section class="ingredienten"
                                    data-ingredients='<%- JSON.stringify(post.ingredients) %>'>
                                    <h2>IngrediÃ«nten:</h2>
                                    <ul class="list-ingredienten"></ul>
                                </section>

                                <section class="instructies" data-ingredients='<%- JSON.stringify(post.steps) %>'>
                                    <h2>Stappen:</h2>
                                    <ol class="list-stappen"></ol>
                                </section>

                                <% if (post.youtube_url && post.youtube_url !=='https://www.youtube.com/embed/null' ) {
                                    %>
                                    <section class="youtube" data-url="<%= post.youtube_url %>">
                                        <iframe width="560" height="315" frameborder="0"
                                            allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture"
                                            allowfullscreen src="<%= post.youtube_url %>"></iframe>
                                    </section>
                                    <% } %>

                                        <% if (post.post_url) { %>
                                            <section class="siteurl" data-url="<%= post.post_url %>">
                                                <a href="<%= post.post_url %>" target="_blank">
                                                    <%= post.post_url %>
                                                </a>
                                            </section>
                                            <% } %>
                            </div>

                            <section class="comments" data-html2canvas-ignore="true">
                                <h3>Comments</h3>
                                <div id="comment-list" class="comment-list"></div>
                                <% if (currentUser) { %>
                                    <form class="comment-form">
                                        <textarea id="comment-input" placeholder="Write a comment..."
                                            rows="3"></textarea>
                                        <button type="button" id="comment-submit">Add Comment</button>
                                    </form>
                                    <% } %>
                            </section>
                        </article>

                        <%- include('partials/gridSearch') %>
                    </section>
            </main>
    </div>
</body>

</html>

<script type="module">
    import initComments from "/js/comments.js";
    const postId = "<%= post.id %>";
    initComments(postId);
</script>